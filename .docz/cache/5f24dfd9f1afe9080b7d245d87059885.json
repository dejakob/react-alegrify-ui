{"remainingRequest":"/Users/jakobkerkhove/alegrify/react-alegrify-ui/node_modules/docz-core/node_modules/babel-loader/lib/index.js?{\"presets\":[\"@babel/preset-env\",\"@babel/preset-react\",[\"/Users/jakobkerkhove/alegrify/react-alegrify-ui/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[[\"/Users/jakobkerkhove/alegrify/react-alegrify-ui/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/jakobkerkhove/alegrify/react-alegrify-ui/node_modules/react-hot-loader/babel.js\"],\"babelrc\":false,\"cacheCompression\":false,\"compact\":false}!/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js","dependencies":[{"path":"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js","mtime":1551899458499},{"path":"/Users/jakobkerkhove/alegrify/react-alegrify-ui/node_modules/cache-loader/dist/cjs.js","mtime":1551899788855},{"path":"/Users/jakobkerkhove/alegrify/react-alegrify-ui/node_modules/docz-core/node_modules/babel-loader/lib/index.js","mtime":1551376331885}],"contextDependencies":[],"result":["'use strict';\n\n(function () {\n  var enterModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).enterModule;\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _view = require('./view');\n\nvar _view2 = _interopRequireDefault(_view);\n\nvar _constants = require('./constants');\n\nvar _helpers = require('./helpers');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (_typeof(call) === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + _typeof(superClass));\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/*\n\n    TODOS\n    =============\n\n    * Multitouch resize gesture\n    * Test in other timezones\n    * Button to add range\n    * Caniuse clientX/clientY? => Seems like it\n    * what about days that are not 86400s\n    * Test RTL\n\n*/\n\n\nvar rangeEquals = function rangeEquals(rangeA, rangeB) {\n  var strA = (rangeA || []).map(function (range) {\n    return range.from + '-' + range.till;\n  }).join('|');\n  var strB = (rangeB || []).map(function (range) {\n    return range.from + '-' + range.till;\n  }).join('|');\n  return strA === strB;\n};\n\nvar WeekSchedule = function (_Component) {\n  _inherits(WeekSchedule, _Component);\n\n  function WeekSchedule() {\n    _classCallCheck(this, WeekSchedule);\n\n    var _this = _possibleConstructorReturn(this, (WeekSchedule.__proto__ || Object.getPrototypeOf(WeekSchedule)).call(this));\n\n    _this.handleRangeMouseDown = _this.handleRangeMouseDown.bind(_this);\n    _this.handleGenericMouseMove = _this.handleGenericMouseMove.bind(_this);\n    _this.handleBodyMouseUp = _this.handleBodyMouseUp.bind(_this);\n    _this.handleTableClick = _this.handleTableClick.bind(_this);\n    return _this;\n  }\n\n  _createClass(WeekSchedule, [{\n    key: 'componentWillMount',\n    value: function componentWillMount() {\n      this.setState({\n        selectedRangeIndex: null,\n        ranges: this.props.ranges || []\n      });\n      this.mouseDownOffset = {\n        x: null,\n        y: null\n      };\n\n      if (typeof document !== 'undefined' && typeof document.body !== 'undefined' && typeof document.body.addEventListener === 'function') {\n        document.addEventListener('mouseup', this.handleBodyMouseUp);\n        document.addEventListener('touchend', this.handleBodyMouseUp);\n      }\n    }\n  }, {\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(newProps) {\n      if (!rangeEquals(newProps.ranges, this.props.ranges)) {\n        this.setState({\n          selectedRangeIndex: null,\n          ranges: this.props.ranges || []\n        });\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (typeof document !== 'undefined' && typeof document.body !== 'undefined' && typeof document.body.removeEventListener === 'function') {\n        document.removeEventListener('mouseup', this.handleBodyMouseUp);\n        document.addEventListener('touchend', this.handleBodyMouseUp);\n      }\n    }\n  }, {\n    key: 'handleRangeMouseDown',\n    value: function handleRangeMouseDown(eventData, rangeIndex) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {}; // Avoid issues on multitouch\n\n      if (!this.state.selectedRangeIndex) {\n        eventData.preventDefault();\n        eventData.stopPropagation();\n\n        var _getCursorOrTouchPosi = (0, _helpers.getCursorOrTouchPosition)(eventData),\n            clientX = _getCursorOrTouchPosi.clientX,\n            clientY = _getCursorOrTouchPosi.clientY;\n\n        this.setState({\n          selectedRangeIndex: rangeIndex\n        });\n        this.mouseDownOffset = {\n          x: clientX,\n          y: clientY\n        };\n        this.gridBoundaries = this.tableRef.getBoundingClientRect();\n        this.resizeMode = options.resize;\n\n        if (eventData.touches && eventData.touches.length === 2) {\n          this.touchDistanceY = Math.abs(eventData.touches[1].clientY - eventData.touches[0].clientY);\n        }\n      }\n    }\n  }, {\n    key: 'handleGenericMouseMove',\n    value: function handleGenericMouseMove(eventData) {\n      if (typeof this.state.selectedRangeIndex === 'number') {\n        var _getCursorOrTouchPosi2 = (0, _helpers.getCursorOrTouchPosition)(eventData),\n            clientX = _getCursorOrTouchPosi2.clientX,\n            clientY = _getCursorOrTouchPosi2.clientY;\n\n        var xDiff = clientX - this.gridBoundaries.left; // Todo constant\n\n        var yDiff = clientY - this.gridBoundaries.top - 64;\n        var moveDownCells = Math.round(yDiff / this.props.cellHeight);\n        var moveRightCells = Math.floor(xDiff / _constants.DEFAULT_CELL_WIDTH);\n\n        if (eventData.touches && eventData.touches.length === 2) {\n          var newTouchDistanceY = Math.abs(eventData.touches[1].clientY - eventData.touches[0].clientY);\n\n          if (this.touchDistanceY) {\n            var updatedRanges = [].concat(_toConsumableArray(this.state.ranges));\n            var increaseFactor = newTouchDistanceY / this.touchDistanceY;\n            var fromMoment = (0, _moment2.default)(updatedRanges[this.state.selectedRangeIndex].from);\n            var tillMoment = (0, _moment2.default)(updatedRanges[this.state.selectedRangeIndex].till);\n            var additionInMinutes = fromMoment.hour() * increaseFactor * 60 - fromMoment.hour() * 60;\n            updatedRanges[this.state.selectedRangeIndex].from = fromMoment.subtract(additionInMinutes / 2, 'minute').toDate().getTime();\n            updatedRanges[this.state.selectedRangeIndex].till = tillMoment.add(additionInMinutes / 2, 'minute').toDate().getTime();\n            eventData.preventDefault();\n            eventData.stopPropagation();\n            this.props.onChange(updatedRanges);\n            this.setState({\n              ranges: updatedRanges\n            });\n          }\n\n          this.touchDistanceY = newTouchDistanceY;\n        } else if (moveDownCells !== 0 || moveRightCells !== 0) {\n          var _updatedRanges = [].concat(_toConsumableArray(this.state.ranges));\n\n          var newHourValue = moveDownCells * this.props.hoursPerCell;\n          var newWeekDayValue = moveRightCells;\n\n          var _fromMoment = (0, _moment2.default)(_updatedRanges[this.state.selectedRangeIndex].from);\n\n          var _tillMoment = (0, _moment2.default)(_updatedRanges[this.state.selectedRangeIndex].till);\n\n          var startOfDay = _fromMoment.clone().startOf('day').toDate().getTime();\n\n          var endOfDay = _fromMoment.clone().endOf('day').toDate().getTime();\n\n          _updatedRanges[this.state.selectedRangeIndex].from = _fromMoment.isoWeekday(newWeekDayValue).toDate().getTime();\n          _updatedRanges[this.state.selectedRangeIndex].till = _tillMoment.isoWeekday(newWeekDayValue).toDate().getTime();\n\n          if (this.resizeMode === 'TOP') {\n            _updatedRanges[this.state.selectedRangeIndex].from = _fromMoment.hour(newHourValue).minute((newHourValue - Math.floor(newHourValue)) * 60).toDate().getTime();\n          }\n\n          if (this.resizeMode === 'BOTTOM') {\n            _updatedRanges[this.state.selectedRangeIndex].till = _tillMoment.hour(newHourValue).minute((newHourValue - Math.floor(newHourValue)) * 60).toDate().getTime();\n          }\n\n          if (!this.resizeMode) {\n            // @Todo what about days that are not 86400s\n            var length = _updatedRanges[this.state.selectedRangeIndex].till - _updatedRanges[this.state.selectedRangeIndex].from;\n            _updatedRanges[this.state.selectedRangeIndex].from = _fromMoment.hour(newHourValue).minute((newHourValue - Math.floor(newHourValue)) * 60).subtract(length / 2000, 's').toDate().getTime();\n            _updatedRanges[this.state.selectedRangeIndex].till = _fromMoment.add(length / 1000, 's').toDate().getTime();\n          }\n\n          var fromTime = _updatedRanges[this.state.selectedRangeIndex].from;\n          var tillTime = _updatedRanges[this.state.selectedRangeIndex].till;\n\n          if (tillTime < fromTime || fromTime < startOfDay && moveRightCells === 0 || tillTime > endOfDay && moveRightCells === 0) {\n            _updatedRanges.splice(this.state.selectedRangeIndex, 1);\n\n            this.props.onChange(_updatedRanges);\n            return this.setState({\n              ranges: _updatedRanges,\n              selectedRangeIndex: null\n            });\n          }\n\n          eventData.preventDefault();\n          eventData.stopPropagation();\n          this.props.onChange(_updatedRanges);\n          this.setState({\n            ranges: _updatedRanges\n          });\n          this.mouseDownOffset = {\n            x: clientX,\n            y: clientY\n          };\n        }\n      }\n    }\n  }, {\n    key: 'handleBodyMouseUp',\n    value: function handleBodyMouseUp() {\n      this.setState({\n        selectedRangeIndex: null\n      });\n    }\n  }, {\n    key: 'handleTableClick',\n    value: function handleTableClick(eventData) {\n      if (eventData.target.localName === 'td') {\n        eventData.preventDefault();\n        eventData.stopPropagation();\n        this.gridBoundaries = this.tableRef.getBoundingClientRect();\n\n        var _getCursorOrTouchPosi3 = (0, _helpers.getCursorOrTouchPosition)(eventData),\n            clientX = _getCursorOrTouchPosi3.clientX,\n            clientY = _getCursorOrTouchPosi3.clientY;\n\n        var xDiff = clientX - this.gridBoundaries.left;\n        var yDiff = clientY - this.gridBoundaries.top - 64;\n        var moveDownCells = Math.floor(yDiff / this.props.cellHeight);\n        var moveRightCells = Math.floor(xDiff / _constants.DEFAULT_CELL_WIDTH);\n        var newWeekDayValue = moveRightCells;\n        var newHourValue = moveDownCells * this.props.hoursPerCell;\n        var fromMoment = (0, _moment2.default)(this.state.ranges.length ? this.state.ranges[0].from : Date.now());\n        var newRange = {\n          from: fromMoment.isoWeekday(newWeekDayValue).hour(newHourValue).minute((newHourValue - Math.floor(newHourValue)) * 60).toDate().getTime(),\n          till: fromMoment.add(3, 'hour').toDate().getTime()\n        };\n        var ranges = [].concat(_toConsumableArray(this.state.ranges), [newRange]);\n        this.props.onChange(ranges);\n        this.setState({\n          ranges: ranges\n        });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var methods = {\n        onRangeMouseDown: this.handleRangeMouseDown,\n        onGenericMouseMove: this.handleGenericMouseMove,\n        onDoubleClick: this.handleTableClick,\n        tableRef: function tableRef(table) {\n          return _this2.tableRef = table;\n        }\n      };\n      return (0, _view2.default)(Object.assign({}, this.props, this.state, methods));\n    }\n  }]);\n\n  return WeekSchedule;\n}(_react.Component);\n\nWeekSchedule.propTypes = {\n  className: _propTypes2.default.string,\n  ranges: _propTypes2.default.arrayOf(_propTypes2.default.shape({\n    from: _propTypes2.default.number,\n    till: _propTypes2.default.number\n  })),\n  cellHeight: _propTypes2.default.number,\n  hoursPerCell: _propTypes2.default.number,\n  cellsPerTimeLabel: _propTypes2.default.number,\n  onChange: _propTypes2.default.func.isRequired\n};\nWeekSchedule.defaultProps = {\n  cellHeight: _constants.DEFAULT_CELL_HEIGHT,\n  hoursPerCell: _constants.DEFAULT_HOURS_PER_CELL,\n  cellsPerTimeLabel: _constants.DEFAULT_CELLS_PER_TIME_LABEL\n};\nWeekSchedule.propExamples = {\n  className: '',\n  ranges: [{\n    from: new Date('2018-10-20T08:00:00').getTime(),\n    till: new Date('2018-10-20T17:00:00').getTime()\n  }],\n  cellHeight: _constants.DEFAULT_CELL_HEIGHT,\n  hoursPerCell: _constants.DEFAULT_HOURS_PER_CELL,\n  cellsPerTimeLabel: _constants.DEFAULT_CELLS_PER_TIME_LABEL\n};\nexports.default = WeekSchedule;\n;\n\n(function () {\n  var reactHotLoader = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).default;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_createClass, \"_createClass\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_react2, \"_react2\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_moment2, \"_moment2\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_propTypes2, \"_propTypes2\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_view2, \"_view2\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_interopRequireDefault, \"_interopRequireDefault\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_toConsumableArray, \"_toConsumableArray\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_classCallCheck, \"_classCallCheck\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_possibleConstructorReturn, \"_possibleConstructorReturn\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(_inherits, \"_inherits\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(rangeEquals, \"rangeEquals\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n  reactHotLoader.register(WeekSchedule, \"WeekSchedule\", \"/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = (typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal : require('react-hot-loader')).leaveModule;\n  leaveModule && leaveModule(module);\n})();",{"version":3,"sources":["/Users/jakobkerkhove/alegrify/react-alegrify-ui/build/week-schedule/index.js"],"names":["Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_react","require","_react2","_interopRequireDefault","_moment","_moment2","_propTypes","_propTypes2","_view","_view2","_constants","_helpers","obj","__esModule","default","_toConsumableArray","arr","Array","isArray","arr2","from","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","rangeEquals","rangeA","rangeB","strA","map","range","till","join","strB","WeekSchedule","_Component","_this","getPrototypeOf","handleRangeMouseDown","bind","handleGenericMouseMove","handleBodyMouseUp","handleTableClick","componentWillMount","setState","selectedRangeIndex","ranges","mouseDownOffset","x","y","document","body","addEventListener","componentWillReceiveProps","newProps","componentWillUnmount","removeEventListener","eventData","rangeIndex","options","arguments","undefined","state","preventDefault","stopPropagation","_getCursorOrTouchPosi","getCursorOrTouchPosition","clientX","clientY","gridBoundaries","tableRef","getBoundingClientRect","resizeMode","resize","touches","touchDistanceY","Math","abs","_getCursorOrTouchPosi2","xDiff","left","yDiff","top","moveDownCells","round","cellHeight","moveRightCells","floor","DEFAULT_CELL_WIDTH","newTouchDistanceY","updatedRanges","concat","increaseFactor","fromMoment","tillMoment","additionInMinutes","hour","subtract","toDate","getTime","add","onChange","_updatedRanges","newHourValue","hoursPerCell","newWeekDayValue","_fromMoment","_tillMoment","startOfDay","clone","startOf","endOfDay","endOf","isoWeekday","minute","fromTime","tillTime","splice","localName","_getCursorOrTouchPosi3","Date","now","newRange","render","_this2","methods","onRangeMouseDown","onGenericMouseMove","onDoubleClick","table","assign","Component","propTypes","className","string","arrayOf","shape","number","cellsPerTimeLabel","func","isRequired","defaultProps","DEFAULT_CELL_HEIGHT","DEFAULT_HOURS_PER_CELL","DEFAULT_CELLS_PER_TIME_LABEL","propExamples"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _view = require('./view');\n\nvar _view2 = _interopRequireDefault(_view);\n\nvar _constants = require('./constants');\n\nvar _helpers = require('./helpers');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   TODOS\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   =============\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Multitouch resize gesture\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Test in other timezones\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Button to add range\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Caniuse clientX/clientY? => Seems like it\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * what about days that are not 86400s\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   * Test RTL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               */\n\nvar rangeEquals = function rangeEquals(rangeA, rangeB) {\n    var strA = (rangeA || []).map(function (range) {\n        return range.from + '-' + range.till;\n    }).join('|');\n    var strB = (rangeB || []).map(function (range) {\n        return range.from + '-' + range.till;\n    }).join('|');\n\n    return strA === strB;\n};\n\nvar WeekSchedule = function (_Component) {\n    _inherits(WeekSchedule, _Component);\n\n    function WeekSchedule() {\n        _classCallCheck(this, WeekSchedule);\n\n        var _this = _possibleConstructorReturn(this, (WeekSchedule.__proto__ || Object.getPrototypeOf(WeekSchedule)).call(this));\n\n        _this.handleRangeMouseDown = _this.handleRangeMouseDown.bind(_this);\n        _this.handleGenericMouseMove = _this.handleGenericMouseMove.bind(_this);\n        _this.handleBodyMouseUp = _this.handleBodyMouseUp.bind(_this);\n        _this.handleTableClick = _this.handleTableClick.bind(_this);\n        return _this;\n    }\n\n    _createClass(WeekSchedule, [{\n        key: 'componentWillMount',\n        value: function componentWillMount() {\n            this.setState({\n                selectedRangeIndex: null,\n                ranges: this.props.ranges || []\n            });\n            this.mouseDownOffset = { x: null, y: null };\n\n            if (typeof document !== 'undefined' && typeof document.body !== 'undefined' && typeof document.body.addEventListener === 'function') {\n                document.addEventListener('mouseup', this.handleBodyMouseUp);\n                document.addEventListener('touchend', this.handleBodyMouseUp);\n            }\n        }\n    }, {\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(newProps) {\n            if (!rangeEquals(newProps.ranges, this.props.ranges)) {\n                this.setState({\n                    selectedRangeIndex: null,\n                    ranges: this.props.ranges || []\n                });\n            }\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            if (typeof document !== 'undefined' && typeof document.body !== 'undefined' && typeof document.body.removeEventListener === 'function') {\n                document.removeEventListener('mouseup', this.handleBodyMouseUp);\n                document.addEventListener('touchend', this.handleBodyMouseUp);\n            }\n        }\n    }, {\n        key: 'handleRangeMouseDown',\n        value: function handleRangeMouseDown(eventData, rangeIndex) {\n            var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\n            // Avoid issues on multitouch\n            if (!this.state.selectedRangeIndex) {\n                eventData.preventDefault();\n                eventData.stopPropagation();\n\n                var _getCursorOrTouchPosi = (0, _helpers.getCursorOrTouchPosition)(eventData),\n                    clientX = _getCursorOrTouchPosi.clientX,\n                    clientY = _getCursorOrTouchPosi.clientY;\n\n                this.setState({\n                    selectedRangeIndex: rangeIndex\n                });\n                this.mouseDownOffset = { x: clientX, y: clientY };\n                this.gridBoundaries = this.tableRef.getBoundingClientRect();\n                this.resizeMode = options.resize;\n\n                if (eventData.touches && eventData.touches.length === 2) {\n                    this.touchDistanceY = Math.abs(eventData.touches[1].clientY - eventData.touches[0].clientY);\n                }\n            }\n        }\n    }, {\n        key: 'handleGenericMouseMove',\n        value: function handleGenericMouseMove(eventData) {\n            if (typeof this.state.selectedRangeIndex === 'number') {\n                var _getCursorOrTouchPosi2 = (0, _helpers.getCursorOrTouchPosition)(eventData),\n                    clientX = _getCursorOrTouchPosi2.clientX,\n                    clientY = _getCursorOrTouchPosi2.clientY;\n\n                var xDiff = clientX - this.gridBoundaries.left;\n                // Todo constant\n                var yDiff = clientY - this.gridBoundaries.top - 64;\n\n                var moveDownCells = Math.round(yDiff / this.props.cellHeight);\n                var moveRightCells = Math.floor(xDiff / _constants.DEFAULT_CELL_WIDTH);\n\n                if (eventData.touches && eventData.touches.length === 2) {\n                    var newTouchDistanceY = Math.abs(eventData.touches[1].clientY - eventData.touches[0].clientY);\n\n                    if (this.touchDistanceY) {\n                        var updatedRanges = [].concat(_toConsumableArray(this.state.ranges));\n                        var increaseFactor = newTouchDistanceY / this.touchDistanceY;\n\n                        var fromMoment = (0, _moment2.default)(updatedRanges[this.state.selectedRangeIndex].from);\n                        var tillMoment = (0, _moment2.default)(updatedRanges[this.state.selectedRangeIndex].till);\n\n                        var additionInMinutes = fromMoment.hour() * increaseFactor * 60 - fromMoment.hour() * 60;\n\n                        updatedRanges[this.state.selectedRangeIndex].from = fromMoment.subtract(additionInMinutes / 2, 'minute').toDate().getTime();\n                        updatedRanges[this.state.selectedRangeIndex].till = tillMoment.add(additionInMinutes / 2, 'minute').toDate().getTime();\n\n                        eventData.preventDefault();\n                        eventData.stopPropagation();\n\n                        this.props.onChange(updatedRanges);\n                        this.setState({\n                            ranges: updatedRanges\n                        });\n                    }\n\n                    this.touchDistanceY = newTouchDistanceY;\n                } else if (moveDownCells !== 0 || moveRightCells !== 0) {\n                    var _updatedRanges = [].concat(_toConsumableArray(this.state.ranges));\n\n                    var newHourValue = moveDownCells * this.props.hoursPerCell;\n                    var newWeekDayValue = moveRightCells;\n\n                    var _fromMoment = (0, _moment2.default)(_updatedRanges[this.state.selectedRangeIndex].from);\n                    var _tillMoment = (0, _moment2.default)(_updatedRanges[this.state.selectedRangeIndex].till);\n\n                    var startOfDay = _fromMoment.clone().startOf('day').toDate().getTime();\n                    var endOfDay = _fromMoment.clone().endOf('day').toDate().getTime();\n\n                    _updatedRanges[this.state.selectedRangeIndex].from = _fromMoment.isoWeekday(newWeekDayValue).toDate().getTime();\n                    _updatedRanges[this.state.selectedRangeIndex].till = _tillMoment.isoWeekday(newWeekDayValue).toDate().getTime();\n\n                    if (this.resizeMode === 'TOP') {\n                        _updatedRanges[this.state.selectedRangeIndex].from = _fromMoment.hour(newHourValue).minute((newHourValue - Math.floor(newHourValue)) * 60).toDate().getTime();\n                    }\n\n                    if (this.resizeMode === 'BOTTOM') {\n                        _updatedRanges[this.state.selectedRangeIndex].till = _tillMoment.hour(newHourValue).minute((newHourValue - Math.floor(newHourValue)) * 60).toDate().getTime();\n                    }\n\n                    if (!this.resizeMode) {\n                        // @Todo what about days that are not 86400s\n                        var length = _updatedRanges[this.state.selectedRangeIndex].till - _updatedRanges[this.state.selectedRangeIndex].from;\n                        _updatedRanges[this.state.selectedRangeIndex].from = _fromMoment.hour(newHourValue).minute((newHourValue - Math.floor(newHourValue)) * 60).subtract(length / 2000, 's').toDate().getTime();\n\n                        _updatedRanges[this.state.selectedRangeIndex].till = _fromMoment.add(length / 1000, 's').toDate().getTime();\n                    }\n\n                    var fromTime = _updatedRanges[this.state.selectedRangeIndex].from;\n                    var tillTime = _updatedRanges[this.state.selectedRangeIndex].till;\n\n                    if (tillTime < fromTime || fromTime < startOfDay && moveRightCells === 0 || tillTime > endOfDay && moveRightCells === 0) {\n                        _updatedRanges.splice(this.state.selectedRangeIndex, 1);\n\n                        this.props.onChange(_updatedRanges);\n                        return this.setState({\n                            ranges: _updatedRanges,\n                            selectedRangeIndex: null\n                        });\n                    }\n\n                    eventData.preventDefault();\n                    eventData.stopPropagation();\n\n                    this.props.onChange(_updatedRanges);\n                    this.setState({\n                        ranges: _updatedRanges\n                    });\n\n                    this.mouseDownOffset = { x: clientX, y: clientY };\n                }\n            }\n        }\n    }, {\n        key: 'handleBodyMouseUp',\n        value: function handleBodyMouseUp() {\n            this.setState({ selectedRangeIndex: null });\n        }\n    }, {\n        key: 'handleTableClick',\n        value: function handleTableClick(eventData) {\n            if (eventData.target.localName === 'td') {\n                eventData.preventDefault();\n                eventData.stopPropagation();\n\n                this.gridBoundaries = this.tableRef.getBoundingClientRect();\n\n                var _getCursorOrTouchPosi3 = (0, _helpers.getCursorOrTouchPosition)(eventData),\n                    clientX = _getCursorOrTouchPosi3.clientX,\n                    clientY = _getCursorOrTouchPosi3.clientY;\n\n                var xDiff = clientX - this.gridBoundaries.left;\n                var yDiff = clientY - this.gridBoundaries.top - 64;\n\n                var moveDownCells = Math.floor(yDiff / this.props.cellHeight);\n                var moveRightCells = Math.floor(xDiff / _constants.DEFAULT_CELL_WIDTH);\n                var newWeekDayValue = moveRightCells;\n\n                var newHourValue = moveDownCells * this.props.hoursPerCell;\n\n                var fromMoment = (0, _moment2.default)(this.state.ranges.length ? this.state.ranges[0].from : Date.now());\n\n                var newRange = {\n                    from: fromMoment.isoWeekday(newWeekDayValue).hour(newHourValue).minute((newHourValue - Math.floor(newHourValue)) * 60).toDate().getTime(),\n                    till: fromMoment.add(3, 'hour').toDate().getTime()\n                };\n\n                var ranges = [].concat(_toConsumableArray(this.state.ranges), [newRange]);\n\n                this.props.onChange(ranges);\n                this.setState({\n                    ranges: ranges\n                });\n            }\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this2 = this;\n\n            var methods = {\n                onRangeMouseDown: this.handleRangeMouseDown,\n                onGenericMouseMove: this.handleGenericMouseMove,\n                onDoubleClick: this.handleTableClick,\n                tableRef: function tableRef(table) {\n                    return _this2.tableRef = table;\n                }\n            };\n\n            return (0, _view2.default)(Object.assign({}, this.props, this.state, methods));\n        }\n    }]);\n\n    return WeekSchedule;\n}(_react.Component);\n\nWeekSchedule.propTypes = {\n    className: _propTypes2.default.string,\n    ranges: _propTypes2.default.arrayOf(_propTypes2.default.shape({\n        from: _propTypes2.default.number,\n        till: _propTypes2.default.number\n    })),\n    cellHeight: _propTypes2.default.number,\n    hoursPerCell: _propTypes2.default.number,\n    cellsPerTimeLabel: _propTypes2.default.number,\n    onChange: _propTypes2.default.func.isRequired\n};\nWeekSchedule.defaultProps = {\n    cellHeight: _constants.DEFAULT_CELL_HEIGHT,\n    hoursPerCell: _constants.DEFAULT_HOURS_PER_CELL,\n    cellsPerTimeLabel: _constants.DEFAULT_CELLS_PER_TIME_LABEL\n};\nWeekSchedule.propExamples = {\n    className: '',\n    ranges: [{\n        from: new Date('2018-10-20T08:00:00').getTime(),\n        till: new Date('2018-10-20T17:00:00').getTime()\n    }],\n    cellHeight: _constants.DEFAULT_CELL_HEIGHT,\n    hoursPerCell: _constants.DEFAULT_HOURS_PER_CELL,\n    cellsPerTimeLabel: _constants.DEFAULT_CELLS_PER_TIME_LABEL\n};\n\nexports.default = WeekSchedule;"]}]}